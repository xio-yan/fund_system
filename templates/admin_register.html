{% extends "layout.html" %}
{% block content %}
<div class="max-w-xl bg-white rounded-2xl shadow-sm border border-slate-200 p-6 mx-auto">
  <h2 class="text-xl font-semibold mb-4">新增使用者（管理員）</h2>
  <form method="post" class="space-y-3">
    <div><label class="block text-sm text-slate-600 mb-1">帳號</label><input name="username" class="w-full border border-slate-200 p-3 rounded-xl" required></div>
    <div><label class="block text-sm text-slate-600 mb-1">顯示名稱</label><input name="display_name" class="w-full border border-slate-200 p-3 rounded-xl"></div>
    <div>
      <label class="block text-sm text-slate-600 mb-1">角色</label>
      <select name="role" class="w-full border border-slate-200 p-3 rounded-xl" id="role-select">
        {% for v,l in roles %}<option value="{{ v }}">{{ l }}</option>{% endfor %}
      </select>
    </div>
    <div id="org-picker" class="hidden">
      <label class="block text-sm text-slate-600 mb-1">所屬系會（限 role=org）</label>
      <select name="org_id" class="w-full border border-slate-200 p-3 rounded-xl">
        <option value="">-- 請選擇 --</option>
        {% for o in orgs %}{% if o.name!='學生會' %}<option value="{{ o.id }}">{{ o.name }}</option>{% endif %}{% endfor %}
      </select>
    </div>
    <div><label class="block text-sm text-slate-600 mb-1">密碼</label><input name="password" class="w-full border border-slate-200 p-3 rounded-xl" required></div>
    <button class="bg-primary hover:bg-secondary text-white px-4 py-2 rounded-xl">建立</button>
  
<div class="mt-3">
  <label class="block text-sm text-slate-600 mb-1">Email（選填）</label>
  <input type="email" name="email" placeholder="user@example.com" class="w-full border border-slate-200 p-2 rounded-xl">
</div>
</form>

</div>
<script>
const sel = document.getElementById('role-select');
const picker = document.getElementById('org-picker');
function togglePicker(){ if(sel.value==='org'){ picker.classList.remove('hidden'); } else { picker.classList.add('hidden'); } }
sel.addEventListener('change', togglePicker); togglePicker();
</script>
{% endblock %}